{"version":3,"file":"main.js","mappings":"uBACIA,EAAsB,CAG1BA,E,GCHAA,EAAyBC,GAEZA,EAAU,OCHvBD,EAAoBE,EAAI,WACvB,GAA0B,iBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAOC,MAAQ,IAAIC,SAAS,cAAb,GACd,MAAOC,GACR,GAAsB,iBAAXC,OAAqB,OAAOA,QALjB,GCAxBP,EAAoBQ,EAAI,CAACC,EAAKC,IAAUC,OAAOC,UAAUC,eAAeC,KAAKL,EAAKC,G,MCAlF,IAAIK,EACAf,EAAoBE,EAAEc,gBAAeD,EAAYf,EAAoBE,EAAEe,SAAW,IACtF,IAAIC,EAAWlB,EAAoBE,EAAEgB,SACrC,IAAKH,GAAaG,IACbA,EAASC,gBACZJ,EAAYG,EAASC,cAAcC,MAC/BL,GAAW,CACf,IAAIM,EAAUH,EAASI,qBAAqB,UACzCD,EAAQE,SAAQR,EAAYM,EAAQA,EAAQE,OAAS,GAAGH,KAK7D,IAAKL,EAAW,MAAM,IAAIS,MAAM,yDAChCT,EAAYA,EAAUU,QAAQ,OAAQ,IAAIA,QAAQ,QAAS,IAAIA,QAAQ,YAAa,KACpFzB,EAAoB0B,EAAIX,G,GCfxBf,EAAoB2B,EAAIT,SAASU,SAAWC,KAAKZ,SAASa,KCA1D,MAAMC,EAAQ,ICEd,SAASC,EAAgBC,EAAGC,GAM1B,OALID,EAAI,IAAGA,EAAIF,KACXE,EAAIF,MAAWE,EAAI,GACnBC,EAAI,IAAGA,EAAIC,IACXD,EAAIC,KAAYD,EAAI,GAEjB,CAAED,EAAAA,EAAGC,EAAAA,GAGd,MCNME,EAAS,CAAC,CAAC,EAAG,GAAI,CAAC,GAAI,GAAI,EAAE,EAAG,GAAI,CAAC,EAAG,IAExCC,EAAS,CAACJ,EAAGC,EAAGI,IAAQA,GAAOA,EAAIL,IAAMK,EAAIL,GAAGC,IAAMI,EAAIL,GAAGC,GAAGK,IAEtE,SAASC,EAAiBC,GAGxB,OADAA,EAAGC,KAAKD,EAAGE,SACJF,ECTT,MAKMG,EAAY,CAACX,EAAGC,EAAGI,YAChBA,EAAIL,GAAGC,GAAGK,IACVD,GAcT,SAASO,EAAOZ,EAAGC,EAAGK,EAAKD,GAGzB,GFhBqB,EAACL,EAAGC,KACzB,GAAID,GAAKF,GAASE,EAAI,EACpB,MAAM,IAAIT,MAAM,6BAGlB,GAAIU,GDfS,ICeMA,EAAI,EACrB,MAAM,IAAIV,MAAM,8BEQlBsB,CAAeb,EAAGC,GAEdI,EAAIL,GAAGC,GAAGK,IACZ,MAAM,IAAIf,MAAM,8BAA8BS,KAAKC,KAKrD,OAFAI,EAAIL,GAAGC,GAAGK,IAAMA,EAETD,EAGT,SAASS,EAAQd,EAAGC,EAAGI,GACrB,OAAOA,EAAIL,GAAGC,GCnChB,MAAMc,EAAc,CAClBf,EAAG,EACHC,EAAG,EACHe,UAAW,EACXC,GAAI,KACJC,OAAQ,EACRC,QAAS,CAAEC,SAAU,GAAIC,QAAS,GAClCC,QAAS,GACTC,GAAI,IACJC,MAAO,CACLC,EAAG,EACHC,EAAG,EACHhC,EAAG,IAqFP,SAASiC,IACP,MAAO,GAAGC,KAAKC,WAGjB,SAASC,EAAe9B,EAAGC,EAAG8B,GAC5B,MAAO,IACFhB,EACHE,GAAIU,IACJ3B,EAAAA,EACAC,EAAAA,EACAe,UAAWY,KAAKI,MAAsB,EAAhBJ,KAAKC,UAC3BX,OAAQU,KAAKC,SAAW,GAAM,GAAK,EACnCV,QAASY,IACTT,QAAS,GACTE,MAAO,CACLC,EAAGG,KAAKC,SACRH,EAAGE,KAAKC,SACRI,EAAGL,KAAKC,WAMd,SAASK,EAAS5B,GAChBA,EAAIiB,IAAM,EAGZ,SAASY,EAAO7B,EAAK8B,EAAOC,GACtB/B,EAAIiB,IAAM,IACZZ,EAAUL,EAAIN,EAAGM,EAAIL,EAAGmC,EAAM/B,KAC9BgC,EAAM/B,EAAK8B,EAAM/B,MAWrB,SACEsB,WAAAA,EACAG,eAAAA,EACAI,SAAAA,EACAC,OAAAA,EACAG,SAzFF,SAAkBhC,EAAKiC,EAAU,IAC/B,MAAO,CACLvC,OAAiBwC,IAAdD,EAAQvC,EAAkBM,EAAIN,EAAIuC,EAAQvC,EAC7CC,OAAiBuC,IAAdD,EAAQtC,EAAkBK,EAAIL,EAAIsC,EAAQtC,EAC7CgB,QAAmBuB,IAAfD,EAAQtB,GAAmBX,EAAIW,GAAKsB,EAAQtB,GAChDD,eAAiCwB,IAAtBD,EAAQvB,UAA0BV,EAAIU,UAAYuB,EAAQvB,UACrEO,QAAmBiB,IAAfD,EAAQhB,GAAmBjB,EAAIiB,GAAKgB,EAAQhB,GAEhDL,OAAQZ,EAAIY,OACZC,QAAS,CACPC,SAAUd,EAAIa,QAAQC,SAASqB,QAC/BpB,QAASf,EAAIa,QAAQE,SAEvBC,QAAS,IAAKhB,EAAIgB,SAClBE,MAAO,CACLC,EAAGnB,EAAIkB,MAAMC,EACbC,EAAGpB,EAAIkB,MAAME,EACbO,EAAG3B,EAAIkB,MAAMS,GAEfS,WAAYpC,EAAIoC,aAuElBC,aAnEF,SAAsBrC,GACpB,OAA0B,IAAnBA,EAAIoC,YAmEX3B,YAAAA,EACA6B,MAlIY,EAmIZC,IAlIU,EAmIVC,KAlIW,EAmIXC,OAlIa,EAmIbC,WAlIiB,ICpBnB,SAASC,EAAIjD,EAAGC,EAAGiD,EAAU7C,GAE3BA,EAAIL,GAAGC,GAAGkD,UAAY,IACjB9C,EAAIL,GAAGC,GAAGkD,aACVD,GCNP,MAAME,EAAa,CACjBC,KAAM,EACNC,MAAO,EACPC,IAAK,EACLC,UAAW,EACXC,iBAAkB,EAClBC,wBAAyB,GCN3B,SAASC,EAASC,GAChB,OAAOA,EAAMhC,KAAKI,MAAOJ,KAAKC,SAAW+B,EAAMtE,SCKjD,SAASuE,IACP,OAAOF,EAASjF,OAAOoF,OAAOV,IAGhC,SAASW,EAA2BC,GAElC,MACMC,EAASC,IACf,IAAIC,EAAOvC,KAAKC,SAAW,GAAM,GAAK,EAKtC,OAHImC,EAAQC,EAASE,GAAQ,GAAKH,EAAQC,EAASE,GAAQ,KACzDA,IAAS,GAEJH,EAAQC,EAASE,ECP1B,SACEC,QAVF,SAAiB9D,EAAK8B,GACpB,MAAMiC,EPWR,SAAuB/D,GACrB,MAAMI,EAAQP,EAAOG,EAAIU,WACzB,OAAOjB,EAAgBO,EAAIN,EAAIU,EAAM,GAAIJ,EAAIL,EAAIS,EAAM,IObtC4D,CAAchE,GAC/BA,EAAIgB,QAAQiD,gBAAkBnE,EAAOiE,EAASrE,EAAGqE,EAASpE,EAAGmC,EAAM/B,KAE9DC,EAAIgB,QAAQiD,eNMnB,SAAiBjE,EAAKkE,EAAMnE,GAC1B,GAAID,EAAOoE,EAAKxE,EAAGwE,EAAKvE,EAAGI,GACzB,MAAM,IAAId,MAAM,eAAeiF,EAAKxE,KAAKwE,EAAKvE,oBAZ7B,EAACD,EAAGC,EAAG+D,EAAO3D,KACjCA,EAAIL,GAAGC,GAAK,IAAKI,EAAIL,GAAGC,MAAO+D,IAc/BS,CAAaD,EAAKxE,EAAGwE,EAAKvE,EAAG,CAAEK,IAAAA,GAAOD,GACtCM,EAAUL,EAAIN,EAAGM,EAAIL,EAAGI,GACxBC,EAAIN,EAAIwE,EAAKxE,EACbM,EAAIL,EAAIuE,EAAKvE,EMbXyE,CAAQpE,EAAK+D,EAAUjC,EAAM/B,OCEjC,GACE+D,QALF,SAAiB9D,EAAKqE,GACpBrE,EAAIU,UAAmBV,EAAIU,UAAW,EAHiC,ICOzE,GACEoD,QALF,SAAiB9D,EAAKqE,GACpBrE,EAAIU,UAAmBV,EAAIU,WAAY,EAHgC,ICMzE,GACEoD,QAVF,SAAiB9D,EAAK8B,GACpB,MAAMwC,EAAO9D,EAAQR,EAAIN,EAAGM,EAAIL,EAAGmC,EAAM/B,KACrCuE,EAAKzB,UAAU0B,OACjBvE,EAAIiB,IAAM,IACNjB,EAAIiB,GAAK,MAAKjB,EAAIiB,GAAK,YACpBqD,EAAKzB,UAAU0B,QCC1B,GACET,QAPF,SAAiB9D,EAAK8B,GACpB,MAAMwC,EAAO9D,EAAQR,EAAIN,EAAGM,EAAIL,EAAGmC,EAAM/B,KAEzCC,EAAIiB,IAAmC,EAA7BqD,EAAKzB,UAAU2B,MAAMC,QC+BjC,GACEX,QA7BF,SAAiB9D,EAAK8B,GACpB,MAAMiC,EZWR,SAAsB/D,GACpB,MAAMI,EAAQH,EAAiBA,EAAiBJ,IAASG,EAAIU,WAC7D,OAAOjB,EAAgBO,EAAIN,EAAIU,EAAM,GAAIJ,EAAIL,EAAIS,EAAM,IYbtCsE,CAAa1E,GAE9B,GADkBF,EAAOiE,EAASrE,EAAGqE,EAASpE,EAAGmC,EAAM/B,KAErD,OAGF,GAAIC,EAAIiB,GAXS,EAWJ,aACX,OAIFjB,EAAIiB,IAAM,EAGV,MAAM0D,EAAS,WACb3E,EACA,IACK+D,EACHpD,GAAI,eACJD,WAtBQA,EAsBQV,EAAIU,UAtBGA,EAAY,EAAK,GAuBxCO,GAAI,eAvBG,IAACP,EA2BZJ,EAAOqE,EAAOjF,EAAGiF,EAAOhF,EAAGgF,EAAQ7C,EAAM/B,OCjB3C,EAXA,SAAiBC,EAAK8B,KCoEtB,EA5CA,SAAiB9B,EAAK8B,GACpB,IAAuB,IAAnB9B,EAAIoC,WACN,OAGFpC,EAAIoC,YAAa,EAGjB,MAAMtB,EAAW,CACf,CAACgC,EAAWC,MAAO,EACnB,CAACD,EAAWK,kBAAmB,EAC/B,CAACL,EAAWM,yBAA0B,EACtC,CAACN,EAAWG,KAAM,EAClB,CAACH,EAAWI,WAAY,EACxB,CAACJ,EAAWE,OAAQ,GASlBhD,EAAIa,QAAQE,SAAWf,EAAIa,QAAQC,SAAS9B,SAC9CgB,EAAIa,QAAQE,QAAUf,EAAIa,QAAQC,SAAS9B,OAAS,GAGtD,MAAM4F,EAAY5E,EAAIa,QAAQC,SAASd,EAAIa,QAAQE,cACjCmB,IAAd0C,IAIJ5E,EAAIa,QAAQE,SAAW,EACnBf,EAAIa,QAAQE,SAAWf,EAAIa,QAAQC,SAAS9B,SAC9CgB,EAAIa,QAAQE,QAAU,GAGxBD,EAAS8D,GAAWd,QAAQ9D,EAAK8B,GAE7B8C,IAAc9B,EAAWI,WAC3B,EAAuBlD,EAAK8B,KAIhC,EA/DA,WACE,MAAM+C,EAAQ,CACZ/B,EAAWC,KACXD,EAAWK,iBACXL,EAAWM,wBACXN,EAAWG,IACXH,EAAWI,UACXJ,EAAWE,OASb,OAAO6B,EAAMvD,KAAKI,MAAMJ,KAAKC,SAAWsD,EAAM7F,UCtBhD,SAAS8F,IACP,MAAMhE,EAAW,GAEjB,IAAK,IAAIiE,EAAI,EAAGA,EALK,GAKeA,GAAK,EACvCjE,EAASX,KAAK,KAGhB,MAAO,CACLW,SAAAA,EACAC,QAAS,GCIb,SAASiE,EAASlD,EAAOmD,GACvB,IAAK,IAAIvF,EAAI,EAAGA,EAAIF,EAAOE,GAAK,EAC9B,IAAK,IAAIC,EAAI,EAAGA,ElBlBL,GkBkBiBA,GAAK,EAC/BsF,EAAUvF,EAAGC,GAKnB,SAASuF,EAAQpD,EAAOmD,EAAWjE,GACjCgE,EAASlD,GAAO,CAACpC,EAAGC,KAClB,MAAMK,EAAMF,EAAOJ,EAAGC,EAAGmC,EAAM/B,KAC3BC,GACFiF,EAAUjF,EAAKgB,MAqDrB,SAAS,EAAKc,GAIZoD,EAAQpD,GAAQ9B,KV7ClB,SAAgBA,GAEd,GAAIsB,KAAKC,SAvCkB,KAwCzB,OAGF,MAAM4D,EAAY,CAChB,CAACrE,EAAUiD,IA1Bf,SAA4BjD,EAAUiD,GAEpC,OADAjD,EAASiD,GAAYR,IACdzC,EAwBmBsE,CAAmBtE,EAAUiD,GACrD,CAACjD,EAAUiD,IAtBf,SAAwBjD,EAAUiD,GAEhC,OADAjD,EAASuE,OAAOtB,EAAU,GACnBjD,EAoBmBwE,CAAexE,EAAUiD,GACjD,CAACjD,EAAUiD,IAlBf,SAAyBjD,EAAUiD,GAEjC,OADAjD,EAASuE,OAAOtB,EAAU,EAAGR,KACtBzC,EAgBmByE,CAAgBzE,EAAUiD,IAG9CA,EAAWzC,KAAKI,MAAMJ,KAAKC,SAAWvB,EAAIa,QAAQC,SAAS9B,QAEjEqE,EAAS8B,EAAT9B,CAAoBrD,EAAIa,QAAQC,SAAUiD,GAE1C/D,EAAIkB,MAAMC,EAAIsC,EAA2BzD,EAAIkB,MAAMC,GACnDnB,EAAIkB,MAAME,EAAIqC,EAA2BzD,EAAIkB,MAAME,GACnDpB,EAAIkB,MAAMS,EAAI8B,EAA2BzD,EAAIkB,MAAMS,IU4BjD6D,CAAOxF,GDtEX,SAAcA,EAAK8B,GACjB,EAAgB9B,EAAK8B,GCsEnB,CAAY9B,EAAK8B,GACjB,EAAY9B,GAQZ6B,EAAO7B,EAAK8B,GANE,CAAC2D,EAAS1F,KAGtB4C,EAAY8C,EAAQ/F,EAAG+F,EAAQ9F,EbnF5B,CACL4E,KAAM,CACJmB,KAAM,SaiFsC3F,SApDlD,SAA6B+B,GAK3BoD,EAAQpD,GAAQ9B,IACdA,EAAIoC,YAAa,KAqDnBuD,CAAoB7D,GChEtB,MAAM8D,EAAU,CAAClG,EAAGC,EAAGkG,IAAUnG,GAAKmG,EAAM,IAAMnG,GAAKmG,EAAM,IAAMlG,GAAKkG,EAAM,IAAMlG,GAAKkG,EAAM,GAEzFC,EAAY,GAoClB,SAASC,EAAoBrG,EAAGC,EAAGqG,EAAOC,GACxC,IAAIC,EAAQvG,EAAIH,EAAQsG,EAAY,EAAQ,EAAJpG,EACxCuG,EAAUE,KAAKD,GAASF,EAAMI,EAC9BF,GAAS,EACTD,EAAUE,KAAKD,GAASF,EAAMrI,EAC9BuI,GAAS,EACTD,EAAUE,KAAKD,GAASF,EAAM5G,EAC9B8G,GAAS,EACTD,EAAUE,KAAKD,QAAqBhE,IAAZ8D,EAAMK,EAAkB,IAAML,EAAMK,EAsK9D,SAASC,EAAYtG,EAAKgB,IApD1B,SAAiBhB,EAAKiG,GACpB,MAAMD,EA5JR,SAAkBhG,GAChB,MAAMuG,EAAO,CACX,EACA,IACA,GACA,IACA,GACA,IACA,IAGIC,EAAUxG,EAAIa,QAAQC,SAASf,KAAK6E,GAAc2B,EAAK3B,KAGvD6B,EADMD,EAAQE,QAAO,CAACL,EAAGjH,IAAMiH,EAAIjH,GAAG,GACzBoH,EAAQxH,QAAW,EAEtC,OA9CF,SAAkBmC,EAAGC,EAAGO,GACtB,IAAIyE,EAAOzI,EAAOyB,EACO,IAArBuH,UAAU3H,SACZoC,EAAID,EAAEC,EAAGO,EAAIR,EAAEQ,EAAGR,EAAIA,EAAEA,GAE1B,MAAM4D,EAAIzD,KAAKI,MAAU,EAAJP,GACfyF,EAAQ,EAAJzF,EAAQ4D,EACZ5F,EAAIwC,GAAK,EAAIP,GACbyF,EAAIlF,GAAK,EAAIiF,EAAIxF,GACjB0F,EAAInF,GAAK,GAAK,EAAIiF,GAAKxF,GAC7B,OAAQ2D,EAAI,GACV,KAAK,EAAGqB,EAAIzE,EAAGhE,EAAImJ,EAAG1H,EAAID,EAAG,MAC7B,KAAK,EAAGiH,EAAIS,EAAGlJ,EAAIgE,EAAGvC,EAAID,EAAG,MAC7B,KAAK,EAAGiH,EAAIjH,EAAGxB,EAAIgE,EAAGvC,EAAI0H,EAAG,MAC7B,KAAK,EAAGV,EAAIjH,EAAGxB,EAAIkJ,EAAGzH,EAAIuC,EAAG,MAC7B,KAAK,EAAGyE,EAAIU,EAAGnJ,EAAIwB,EAAGC,EAAIuC,EAAG,MAC7B,KAAK,EAAGyE,EAAIzE,EAAGhE,EAAIwB,EAAGC,EAAIyH,EAE5B,MAAO,CACLT,EAAG9E,KAAKyF,MAAU,IAAJX,GACdzI,EAAG2D,KAAKyF,MAAU,IAAJpJ,GACdyB,EAAGkC,KAAKyF,MAAU,IAAJ3H,IAyBT4H,CAAShH,EAAIkB,MAAMC,EAAGnB,EAAIkB,MAAME,EAAGqF,GA4I5BQ,CAASjH,IAlDzB,SAA2BkH,EAAIC,EAAInH,EAAKU,EAAWsF,EAAOC,GACxD,MAAMmB,EAAgBF,EAAK,EACrBG,EAAiBH,EAAKpB,EAAY,EAClCwB,EAAeH,EAAK,EACpBI,EAAkBJ,EAAKrB,EAAY,EAEnC0B,EAAWN,EACXO,EAAYP,EAAKpB,EAAY,EAC7B4B,EAAUP,EACVQ,EAAaR,EAAKrB,EAAY,EAgC9B8B,EA3BQ,CACZ,CAAC,SAAY,CACXH,EAJe,EAKfC,EANgB,EAOhBD,EACAE,EARgB,GAUlB,CAAC,OAAU,CACTH,EAXgB,EAYhBE,EACAD,EAbgB,EAchBC,EAbe,GAejB,CAAC,QAAW,CACVF,EACAE,EAlBgB,EAmBhBF,EAlBe,EAmBfG,EApBgB,GAsBlB,CAAC,UAAa,CACZH,EAvBgB,EAwBhBG,EAvBe,EAwBfF,EAzBgB,EA0BhBE,IAIiBjH,IA/EvB,SAAwB4G,EAAcC,EAAiBC,EAAUI,EAAQ5B,EAAOC,EAAWwB,GACzF,IAAK,IAAI9H,EAAI2H,EAAc3H,GAAK4H,EAAiB5H,GAAK,EAE/CiG,EAAQ4B,EAAU7H,EAAGiI,IACxB7B,EAAoByB,EAAU7H,EAAGqG,EAAOC,GAIrCL,EAAQ6B,EAAW9H,EAAGiI,IACzB7B,EAAoB0B,EAAW9H,EAAGqG,EAAOC,GAwE7C4B,CAAeP,EAAcC,EAAiBC,EAAUI,EAAQ5B,EAAOC,EAAWwB,GA/FpF,SAAwBL,EAAeC,EAAgBK,EAASE,EAAQ5B,EAAOC,EAAW0B,GACxF,IAAK,IAAIjI,EAAI0H,EAAe1H,GAAK2H,EAAgB3H,GAAK,EAE/CkG,EAAQlG,EAAGgI,EAASE,IACvB7B,EAAoBrG,EAAGgI,EAAS1B,EAAOC,GAIpCL,EAAQlG,EAAGiI,EAAYC,IAC1B7B,EAAoBrG,EAAGiI,EAAY3B,EAAOC,GAuF9C6B,CAAeV,EAAeC,EAAgBK,EAASE,EAAQ5B,EAAOC,EAAW0B,GA1GnF,SAAqBP,EAAeC,EAAgBC,EAAcC,EAAiBK,EAAQ5B,EAAOC,GAChG,IAAK,IAAIvG,EAAI0H,EAAe1H,GAAK2H,EAAgB3H,GAAK,EACpD,IAAK,IAAIC,EAAI2H,EAAc3H,GAAK4H,EAAiB5H,GAAK,EAC/CiG,EAAQlG,EAAGC,EAAGiI,IACjB7B,EAAoBrG,EAAGC,EAAGqG,EAAOC,GAuGvC8B,CAAYX,EAAeC,EAAgBC,EAAcC,EAAiBK,EAAQ5B,EAAOC,GAQzF+B,CAFUhI,EAAIN,EAAIoG,EACR9F,EAAIL,EAAImG,EACM9F,EAAKA,EAAIU,UAAWsF,EAAOC,GAgDhBgC,CAAQjI,EAAKgB,EAAQiF,WAa1D,SAASiC,EAAOC,GACd,MAAMlC,EAAYkC,EAAOC,IAAIC,gBAAgB7I,KAAmBI,MAZlE,SAAcqG,GACZA,EAAUE,KAAKmC,KAAK,GAEpB,IAAK,IAAIvD,EAAI,EAAGA,EAAIvF,KAA4CuF,GAAK,EAInEkB,EAAUE,KAAKpB,EAAI,GAAK,IAO1BuD,CAAKrC,GA3CP,SAAuBnE,EAAOmE,GAE5BjB,EAASlD,GAAO,CAACpC,EAAGC,KAClB,MAAM2E,EAAO9D,EAAQd,EAAGC,EAAGmC,EAAM/B,KAC7BuE,EAAKzB,WAdb,SAAsBnD,EAAGC,EAAGkD,EAAWoD,GACjCpD,EAAU0B,MAThB,SAAgC2C,EAAIC,EAAInB,EAAOC,GAC7C,IAAK,IAAIvG,EAAIwH,EAAK,EAAGxH,EAAIwH,EAAKpB,EAAY,EAAGpG,GAAK,EAChD,IAAK,IAAIC,EAAIwH,EAAK,EAAGxH,EAAIwH,EAAKrB,EAAY,EAAGnG,GAAK,EAChDoG,EAAoBrG,EAAGC,EAAGqG,EAAOC,GAWnCsC,CAJA7I,GAAKoG,EACLnG,GAAKmG,EAES,CAAEM,EAAG,IAAKzI,EAAG,GAAIyB,EAAG,GACE6G,GASlCuC,CAAa9I,EAAGC,EAAG2E,EAAKzB,UAAWoD,MAyCvCwC,CAAcN,EAAOrG,MAAOmE,GAE5Bf,EAAQiD,EAAOrG,MAAOwE,EAAa,CAAEL,UAAAA,IAGrCkC,EAAOC,IAAIM,aAAazC,EAAW,EAAG,GC9QxC,MAAM0C,EAAe,GACrB,IAAI7G,EACA8G,EAAU,EACd5K,OAAO4K,QAAU,EAGjB,MAAMC,EAAMlK,SAASmK,eAAe,OAC9BC,EAAOpK,SAASmK,eAAe,QAC/BE,EAAWH,EAAII,YAAczJ,EAC7B0J,EAAYL,EAAIM,apBXP,GoBaTC,EAAqB,UACClH,IAAtByG,EAAaU,WACSnH,IAAtByG,EAAaW,OACjBX,EAAa3I,IAAMF,EAAO6I,EAAaU,KAAMV,EAAaW,KAAMxH,EAAM/B,OAGlEwJ,EAAexL,IACnB4K,EAAaU,KAAOG,SAASzL,EAAE2B,EAAIsJ,EAAU,IAC7CL,EAAaW,KAAOE,SAASzL,EAAE4B,EAAIuJ,EAAW,IAC9CE,KAGF,SAASK,IACP,MAAM,IAAEzJ,GAAQ2I,OAEJzG,IAARlC,GAAsBA,GAAOA,EAAIiB,IAAM,EACzCmI,IAIFL,EAAKW,UAAY,MAAM1J,EAAIN,YACjBM,EAAIL,aACH6J,SAASxJ,EAAIiB,GAAI,oBACZjB,EAAIa,QAAQC,oBACjBd,EAAIW,UAGjB,SAASgJ,EAAgBC,GACvB9H,EAAQ8H,EACRf,EAAIgB,iBAAiB,YAAaN,GAElCO,YAAYL,EAAmB,KCpCjC,SAASM,EAAiB9E,EAAW+E,GACnC,MAAMC,EAAOC,YAAYC,MAEzB,OADAlF,EAAU+E,GACHE,YAAYC,MAAQF,EAG7B,SAAS,EAAKnI,EAAOqG,GACnB,EAAUrG,GACVoG,EAAOC,GD2CT,IAAgBiC,EAAAA,ECtCP,CAHIL,EAAiB,EAAWjI,GAC5BiI,EAAiB7B,EAAQC,IDyCpCnK,OAAO4K,UACPA,GAAW,EAEX5K,OAAOqM,WAAa,GAAGzB,KAAW0B,KAAKH,eAAeC,EAAM,OAAOA,EAAM,kBACzEX,ICzCAc,uBAAsB,IAAM,EAAKzI,EAAOqG,KDwB1CqC,OAAOnM,UAAUoM,SAAW,WAC1B,IAAkB1F,EAChB2F,EADEC,EAAO,EAEX,GAAoB,IAAhB9M,KAAKmB,OAAc,OAAO2L,EAC9B,IAAK5F,EAAI,EAAGA,EAAIlH,KAAKmB,OAAQ+F,GAAK,EAChC2F,EAAM7M,KAAK+M,WAAW7F,GACtB4F,GAASA,GAAQ,GAAKA,EAAQD,EAC9BC,GAAQ,EAEV,OAAOA,GC6CT,QAxBA,WACE,MAAM7I,EHqCR,WAEE,MAAMA,EAAQ,CACZ/B,IAAK,IASP,OA/DF,SAAmB+B,GACjBkD,EAASlD,GAAO,CAACpC,EAAGC,MAdtB,SAAkBD,EAAGC,EAAGI,EAAK2D,EAAQ,CAAEb,UAAW,UACjCX,IAAXnC,EAAIL,KACNK,EAAIL,GAAK,IAGXK,EAAIL,GAAGC,GAAK+D,EAUVmH,CAASnL,EAAGC,EAAGmC,EAAM/B,QAsDvB+K,CAAUhJ,GAvFZ,SAAkBA,GAChBkD,EAASlD,GAAO,CAACpC,EAAGC,KACd2B,KAAKC,SAAW,IAClBjB,EAAOZ,EAAGC,EAAG,EAAkBD,EAAGC,EAAGmF,GAAWhD,EAAM/B,QAuF1DgL,CAASjJ,GArDX,SAAuBA,GACrBkD,EAASlD,GAAO,CAACpC,EAAGC,KACd2B,KAAKC,SAAW,IAElBoB,EAAYjD,EAAGC,EbhEZ,CACL4E,KAAM,CACJmB,KAAM,Sa8DsB5D,EAAM/B,KAGpC4C,EAAYjD,EAAGC,EADO,CAAE6E,MAAO,CAAEkB,KAAM,QAASjB,MAAO,EAAI9E,ElB5EhD,KkB6EsBmC,EAAM/B,QA+CzCiL,CAAclJ,GAEd9D,OAAOiN,WAAanJ,EACbA,EGjDOoJ,GACR/C,EFwJR,SAAsBrG,GACpB,MAAMqJ,EAASxM,SAASmK,eAAe,OACvCqC,EAAOC,MAAQ5L,KACf2L,EAAOE,OAASzL,IAEhB,MAAMuI,EAAS,CACbrG,MAAAA,EACAsG,IAAK+C,EAAOG,WAAW,OAMzB,OAHAnD,EAAOC,IAAM+C,EAAOG,WAAW,MAC/BnD,EAAOC,IAAImD,uBAAwB,EAE5BpD,EErKQqD,CAAa1J,IAvB9B,SAAaA,EAAOqG,GAYlBoC,uBAAsB,IAAM,EAAKzI,EAAOqG,KAExC2B,aAAY,KACV2B,QAAQC,IAAIpB,KAAKH,MAAOnM,OAAOqM,cAC9B,KAEHV,EAAgB7H,GAMhB6J,CAAI7J,EAAOqG,IC/Eb,IAEA,MAAMyD,EAAS,IAAIC,OAAO,IAAIC,IAAI,mBAElCF,EAAOG,UAAY,SAASC,GAC1BP,QAAQC,IAAI,uBAAwBM,EAAM7F,OAG5C2D,aAAY,KACV8B,EAAOK,MAAMC,MAAMC,IACjBA,EAAaC,OAAOC,YAAY,qBAChCZ,QAAQC,IAAI,kBAAmBS,QAEhC,M","sources":["webpack://evo-3/webpack/bootstrap","webpack://evo-3/webpack/runtime/get javascript chunk filename","webpack://evo-3/webpack/runtime/global","webpack://evo-3/webpack/runtime/hasOwnProperty shorthand","webpack://evo-3/webpack/runtime/publicPath","webpack://evo-3/webpack/runtime/jsonp chunk loading","webpack://evo-3/./src/domain/world/constants.js","webpack://evo-3/./src/domain/world/coords.js","webpack://evo-3/./src/domain/world/bot_finder.js","webpack://evo-3/./src/domain/world/map_modifier.js","webpack://evo-3/./src/domain/bot.js","webpack://evo-3/./src/domain/resource.js","webpack://evo-3/./src/domain/program/constants.js","webpack://evo-3/./src/utils.js","webpack://evo-3/./src/domain/mutation.js","webpack://evo-3/./src/domain/command/move.js","webpack://evo-3/./src/domain/command/rotate_clockwise.js","webpack://evo-3/./src/domain/command/rotate_counterclockwise.js","webpack://evo-3/./src/domain/command/eat.js","webpack://evo-3/./src/domain/command/eat_solar.js","webpack://evo-3/./src/domain/command/clone.js","webpack://evo-3/./src/domain/command/overpopulation.js","webpack://evo-3/./src/domain/command/index.js","webpack://evo-3/./src/domain/program/program.js","webpack://evo-3/./src/domain/world.js","webpack://evo-3/./src/drawer.js","webpack://evo-3/./src/debug_window.js","webpack://evo-3/./src/app.js","webpack://evo-3/./src/main.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","const WIDTH = 150;\nconst HEIGHT = 80;\n\nexport {\n  WIDTH,\n  HEIGHT,\n};\n","import { HEIGHT, WIDTH } from './constants';\n\nfunction normalizeCoords(x, y) {\n  if (x < 0) x = WIDTH - 1;\n  if (x > WIDTH - 1) x = 0;\n  if (y < 0) y = HEIGHT - 1;\n  if (y > HEIGHT - 1) y = 0;\n\n  return { x, y };\n}\n\nconst validateCoords = (x, y) => {\n  if (x >= WIDTH || x < 0) {\n    throw new Error(`x should be from 0 to ${WIDTH}`);\n  }\n\n  if (y >= HEIGHT || y < 0) {\n    throw new Error(`x should be from 0 to ${WIDTH}`);\n  }\n};\n\nexport {\n  normalizeCoords,\n  validateCoords,\n};\n","// Returns coordinates behind the back of the bot\n// Returns coordinates behind the back of the bot\nimport { normalizeCoords } from './coords';\n\n//              left    top      right    bottom\nconst SHIFTS = [[1, 0], [0, -1], [-1, 0], [0, 1]];\n\nconst getBot = (x, y, map) => map && map[x] && map[x][y] && map[x][y].bot;\n\nfunction rightCyclicShift(ar) {\n  // Mutates ar for performance purposes\n  ar.push(ar.shift());\n  return ar;\n}\n\nfunction frontPosition(bot) {\n  const shift = SHIFTS[bot.direction];\n  return normalizeCoords(bot.x + shift[0], bot.y + shift[1]);\n}\n\nfunction backPosition(bot) {\n  const shift = rightCyclicShift(rightCyclicShift(SHIFTS))[bot.direction];\n  return normalizeCoords(bot.x + shift[0], bot.y + shift[1]);\n}\n\n// function aheadBotByBot(bot, world) {\n//   const position = frontPosition(bot);\n//   return aheadBotByPosition(position, world);\n// }\n\n// const aheadBotByPosition = (position, world) => {\n//   getBot(position.x, position.y, world.map);\n// };\n// const behindBotByPosition = (position, world) => getBot(position.x, position.y, world.map);\n\n// function getBehindBot(bot, world) {\n//   const position = backPosition(bot);\n// }\n\nfunction eachNeighborBot(bot, world, performer, botIsProcessing) {\n  for (let x = -1; x <= 1; x += 1) {\n    for (let y = -1; y <= 1; y += 1) {\n      if (x !== 0 && y !== 0) {\n        const coords = normalizeCoords(bot.x + x, bot.y + y);\n        const neighborBot = getBot(coords.x, coords.y, world.map);\n        if (neighborBot && botIsProcessing(neighborBot)) {\n          performer(neighborBot);\n        }\n      }\n    }\n  }\n}\n\nexport {\n  eachNeighborBot,\n  backPosition,\n  frontPosition,\n  //  aheadBotByPosition,\n  getBot,\n};\n","import { getBot } from './bot_finder';\nimport { validateCoords } from './coords';\n\nconst setCellProps = (x, y, value, map) => {\n  map[x][y] = { ...map[x][y], ...value };\n  return map;\n};\n\nconst removeBot = (x, y, map) => {\n  delete map[x][y].bot;\n  return map;\n};\n\nfunction moveBot(bot, dest, map) {\n  if (getBot(dest.x, dest.y, map)) {\n    throw new Error(`Bot in cell ${dest.x}:${dest.y} already exists`);\n  }\n  // Write moved bot to new cell and remove this bot from old cell\n  setCellProps(dest.x, dest.y, { bot }, map);\n  removeBot(bot.x, bot.y, map);\n  bot.x = dest.x;\n  bot.y = dest.y;\n}\n\nfunction addBot(x, y, bot, map) {\n  validateCoords(x, y);\n\n  if (map[x][y].bot) {\n    throw new Error(`Bot already exists in cell ${x}:${y}`);\n  }\n  // debug('addBot');\n  map[x][y].bot = bot;\n\n  return map;\n}\n\nfunction getCell(x, y, map) {\n  return map[x][y];\n}\n\nexport {\n  addBot,\n  getCell,\n  moveBot,\n  removeBot,\n};\n","import { removeBot } from './world/map_modifier';\n\nconst DEFAULT_BOT = {\n  x: 0,\n  y: 0,\n  direction: 0,\n  id: null,\n  rotate: 1,\n  program: { commands: [], current: 0 }, // TODO: ссылка на общий объект\n  options: {}, // TODO: ссылка на общий объект\n  xp: 127,\n  style: {\n    h: 1,\n    s: 1,\n    b: 1,\n  },\n};\n\nconst RIGHT = 0;\nconst TOP = 1;\nconst LEFT = 2;\nconst BOTTOM = 3;\nconst DEFAULT_XP = 10;\n\n/*\n* @param direction {Number} can be 0 (right), 90 (top), 180 (left), 270 (bottom)\n* @param rotate {Number} can be 1 (clockwise) or -1 (counterclockwise)\n*/\n// function rotate1(direction, rotate) {\n//   return ((direction + rotate) & 3);\n// }\n\n/*\n* @param direction {Number} can be 0 (right), 90 (top), 180 (left), 270 (bottom)\n* @param rotate {Number} can be 1 (clockwise) or -1 (counterclockwise)\n*/\n// function rotate2(direction, rotate) {\n//   return ((direction + rotate) & 3);\n// }\n\n// function rightPosition(bot) {\n//   return World.normalizeCoords(bot.x + 1, bot.y + 0);\n// }\n//\n// function topPosition(bot) {\n//   return World.normalizeCoords(bot.x + 0, bot.y - 1);\n// }\n//\n// function leftPosition(bot) {\n//   return World.normalizeCoords(bot.x - 1, bot.y + 0);\n// }\n//\n// function bottomPosition(bot) {\n//   return World.normalizeCoords(bot.x + 0, bot.y + 1);\n// }\n\nfunction cloneBot(bot, changes = {}) {\n  return {\n    x: changes.x === undefined ? bot.x : changes.x,\n    y: changes.y === undefined ? bot.y : changes.y,\n    id: changes.id === undefined ? bot.id : changes.id,\n    direction: changes.direction === undefined ? bot.direction : changes.direction,\n    xp: changes.xp === undefined ? bot.xp : changes.xp,\n\n    rotate: bot.rotate,\n    program: {\n      commands: bot.program.commands.slice(),\n      current: bot.program.current,\n    },\n    options: { ...bot.options },\n    style: {\n      h: bot.style.h,\n      s: bot.style.s,\n      v: bot.style.v,\n    },\n    processing: bot.processing,\n  };\n}\n\nfunction isProcessing(bot) {\n  return bot.processing === false;\n}\n//\n// function isDirectionRight(bot) {\n//   return bot.direction === 0;\n// }\n//\n// function isDirectionLeft(bot) {\n//   return bot.direction === 2;\n// }\n//\n// function isDirectionTop(bot) {\n//   return bot.direction === 1;\n// }\n//\n// function isDirectionBottom(bot) {\n//   return bot.direction === 3;\n// }\n\nfunction generateId() {\n  return `${Math.random()}`;\n}\n\nfunction generateRandom(x, y, generateProgram) {\n  return {\n    ...DEFAULT_BOT,\n    id: generateId(),\n    x,\n    y,\n    direction: Math.floor(Math.random() * 4),\n    rotate: Math.random() > 0.5 ? 1 : -1,\n    program: generateProgram(),\n    options: {},\n    style: {\n      h: Math.random(),\n      s: Math.random(),\n      v: Math.random(),\n    },\n  };\n}\n\n// tick of the bot live\nfunction liveStep(bot) {\n  bot.xp -= 1;\n}\n\nfunction tryDie(bot, world, onDie) {\n  if (bot.xp <= 0) {\n    removeBot(bot.x, bot.y, world.map);\n    onDie(bot, world.map);\n  }\n}\n\nexport {\n  isProcessing,\n  generateRandom,\n  liveStep,\n  tryDie,\n};\n\nexport default {\n  generateId,\n  generateRandom,\n  liveStep,\n  tryDie,\n  cloneBot,\n  isProcessing,\n  DEFAULT_BOT,\n  RIGHT,\n  TOP,\n  LEFT,\n  BOTTOM,\n  DEFAULT_XP,\n};\n","// import { validateCoords } from './world';\n\nfunction add(x, y, resource, map) {\n  // validateCoords(x, y);\n  map[x][y].resources = {\n    ...map[x][y].resources,\n    ...resource,\n  };\n}\n\nfunction generateRandom() {\n  return {\n    food: {\n      type: 'food',\n    },\n  };\n}\n\nexport {\n  add,\n  generateRandom,\n};\n","const OPERATIONS = {\n  MOVE: 0,\n  CLONE: 1,\n  EAT: 2,\n  EAT_SOLAR: 3,\n  ROTATE_CLOCKWISE: 4,\n  ROTATE_COUNTERCLOCKWISE: 5,\n  // OVERPOPULATION: 6,\n  // KILL_NEIGHBORS: 7,\n};\n\nexport {\n  OPERATIONS,\n};\n","function arRandom(array) {\n  return array[Math.floor((Math.random() * array.length))];\n}\n\nexport {\n  arRandom,\n};\n","import { OPERATIONS } from './program/constants';\n\nimport { arRandom } from '../utils';\n\nconst MUTATION_PROBABILITY = 0.001;\n\nfunction randomOperationCode() {\n  return arRandom(Object.values(OPERATIONS));\n}\n\nfunction randomChangeStyleComponent(value) {\n  // const minComponentValue = 0;\n  const maxComponentValue = 1;\n  const change = maxComponentValue / 100;\n  let sign = Math.random() > 0.5 ? 1 : -1;\n\n  if (value + change * sign <= 0 || value + change * sign >= 1) {\n    sign *= -1;\n  }\n  return value + change * sign;\n}\n\nfunction mutateSubstitution(commands, position) {\n  commands[position] = randomOperationCode();\n  return commands;\n}\n\nfunction mutateDeletion(commands, position) {\n  commands.splice(position, 1);\n  return commands;\n}\n\nfunction mutateInsertion(commands, position) {\n  commands.splice(position, 0, randomOperationCode());\n  return commands;\n}\n\n// function randomOperationsPosition(commands) {\n//   return Math.floor(Math.random() * bot.program.commands.length);\n// }\n\nfunction mutate(bot) {\n  // Mutations are very rare\n  if (Math.random() > MUTATION_PROBABILITY) {\n    return;\n  }\n\n  const mutations = [\n    (commands, position) => mutateSubstitution(commands, position),\n    (commands, position) => mutateDeletion(commands, position),\n    (commands, position) => mutateInsertion(commands, position),\n  ];\n\n  const position = Math.floor(Math.random() * bot.program.commands.length);\n\n  arRandom(mutations)(bot.program.commands, position);\n\n  bot.style.h = randomChangeStyleComponent(bot.style.h);\n  bot.style.s = randomChangeStyleComponent(bot.style.s);\n  bot.style.v = randomChangeStyleComponent(bot.style.v); //  * (bot.xp * 2 / 255)\n\n  // // Substitution\n  // bot.program.commands[position] = randomOperationCode();\n  //\n  // // Deletion\n  // bot.program.commands.splice(position, 1);\n  //\n  // // Insertion\n  // bot.program.commands.splice(position, 0, randomOperationCode());\n}\n\nexport {\n  mutate,\n};\n","import { frontPosition, getBot } from '../world/bot_finder';\nimport { moveBot } from '../world/map_modifier';\n\nfunction execute(bot, world) {\n  const position = frontPosition(bot);\n  bot.options.hasBotInFront = !!getBot(position.x, position.y, world.map);\n\n  if (!bot.options.hasBotInFront) {\n    moveBot(bot, position, world.map);\n  }\n}\n\nexport default {\n  execute,\n};\n","/*\n* @param direction {Number} can be 0 (right), 1 (top), 2 (left), 3 (bottom)\n* @param rotate {Number} can be 1 (clockwise) or -1 (counterclockwise)\n*/\nconst rotate = (direction, rotateCounts) => (direction + rotateCounts) & 3;\n\nfunction execute(bot, _world) {\n  bot.direction = rotate(bot.direction, 1);\n}\n\nexport default {\n  execute,\n};\n","/*\n* @param direction {Number} can be 0 (right), 1 (top), 2 (left), 3 (bottom)\n* @param rotate {Number} can be 1 (clockwise) or -1 (counterclockwise)\n*/\n// TODO: code duplication with rotate_clockwise.js\nconst rotate = (direction, rotateCounts) => (direction + rotateCounts) & 3;\n\nfunction execute(bot, _world) {\n  bot.direction = rotate(bot.direction, -1);\n}\n\nexport default {\n  execute,\n};\n","import { getCell } from '../world/map_modifier';\n\nfunction execute(bot, world) {\n  const cell = getCell(bot.x, bot.y, world.map);\n  if (cell.resources.food) {\n    bot.xp += 100;\n    if (bot.xp > 255) bot.xp = 255;\n    delete cell.resources.food;\n  }\n}\n\nexport default {\n  execute,\n};\n","import { getCell } from '../world/map_modifier';\n\nfunction execute(bot, world) {\n  const cell = getCell(bot.x, bot.y, world.map);\n\n  bot.xp += cell.resources.light.power * 3;\n}\n\nexport default {\n  execute,\n};\n","import Bot from '../bot';\nimport { backPosition, getBot } from '../world/bot_finder';\nimport { addBot } from '../world/map_modifier';\n\nconst CLONE_RATE = 2;\n\nconst turn = (direction) => (direction + 2) & 3;\n\nfunction execute(bot, world) {\n  const position = backPosition(bot);\n  const botInBack = getBot(position.x, position.y, world.map);\n  if (botInBack) {\n    return;\n  }\n\n  if (bot.xp < Bot.DEFAULT_XP * CLONE_RATE) {\n    return;\n  }\n\n  // Old bot lost half xp\n  bot.xp /= 2;\n\n  // New bot stays behind old, has default XP\n  const newBot = Bot.cloneBot(\n    bot,\n    {\n      ...position,\n      id: Bot.generateId(),\n      direction: turn(bot.direction),\n      xp: Bot.DEFAULT_XP,\n    },\n  );\n\n  addBot(newBot.x, newBot.y, newBot, world.map);\n}\n\nexport default {\n  execute,\n};\n","import { isProcessing } from '../bot';\nimport { eachNeighborBot } from '../world/bot_finder';\n\nconst xpReduction = (neighbors) => neighbors / 3;\n\nfunction execute(bot, world) {\n  return;\n  let neighbors = 0;\n\n  eachNeighborBot(bot, world, (_) => {\n    neighbors += 1;\n  }, isProcessing);\n\n  bot.xp -= xpReduction(neighbors);\n}\n\nexport default {\n  execute,\n};\n","import { OPERATIONS } from '../program/constants';\nimport Move from './move';\nimport RotateClockwise from './rotate_clockwise';\nimport RotateCounterclockwise from './rotate_counterclockwise';\nimport Eat from './eat';\nimport EatSolar from './eat_solar';\nimport Clone from './clone';\nimport Overpopulation from './overpopulation';\n\n// Generates random operations sequence\nfunction rand() {\n  const items = [\n    OPERATIONS.MOVE,\n    OPERATIONS.ROTATE_CLOCKWISE,\n    OPERATIONS.ROTATE_COUNTERCLOCKWISE,\n    OPERATIONS.EAT,\n    OPERATIONS.EAT_SOLAR,\n    OPERATIONS.CLONE,\n    // OPERATIONS.OVERPOPULATION,\n    // OPERATIONS.KILL_NEIGHBORS,\n  ];\n\n  // if (Math.random() > 0.99) {\n  // items.push(OPERATIONS.CLONE);\n  // }\n\n  return items[Math.floor(Math.random() * items.length)];\n}\n\nfunction execute(bot, world) {\n  if (bot.processing === true) {\n    return;\n  }\n\n  bot.processing = true;\n  // debug(bot);\n\n  const commands = {\n    [OPERATIONS.MOVE]: Move,\n    [OPERATIONS.ROTATE_CLOCKWISE]: RotateClockwise,\n    [OPERATIONS.ROTATE_COUNTERCLOCKWISE]: RotateCounterclockwise,\n    [OPERATIONS.EAT]: Eat,\n    [OPERATIONS.EAT_SOLAR]: EatSolar,\n    [OPERATIONS.CLONE]: Clone,\n    // [OPERATIONS.OVERPOPULATION]: Overpopulation,\n    // [OPERATIONS.KILL_NEIGHBORS]: CommandKillNeighbors,\n  };\n\n  // const operation = bot.program.commands.shift();\n  // if (operation === undefined) { return; }\n  // bot.program.commands.push(operation);\n\n  if (bot.program.current >= bot.program.commands.length) {\n    bot.program.current = bot.program.commands.length - 1;\n  }\n\n  const operation = bot.program.commands[bot.program.current];\n  if (operation === undefined) {\n    return;\n  }\n\n  bot.program.current += 1;\n  if (bot.program.current >= bot.program.commands.length) {\n    bot.program.current = 0;\n  }\n\n  commands[operation].execute(bot, world);\n\n  if (operation === OPERATIONS.EAT_SOLAR) {\n    Overpopulation.execute(bot, world);\n  }\n}\n\nexport default {\n  execute,\n  rand,\n};\n","import Command from '../command';\n\nconst PROGRAM_LENGTH = 10;\n\nfunction generate() {\n  const commands = [];\n  // Create program with PROGRAM_LENGTH commands\n  for (let i = 0; i < PROGRAM_LENGTH; i += 1) {\n    commands.push(Command.rand());\n  }\n\n  return {\n    commands,\n    current: 0,\n  };\n}\n\nfunction step(bot, world) {\n  Command.execute(bot, world);\n}\n\nexport {\n  generate,\n  step,\n};\n","import {\n  generateRandom as botGenerateRandom,\n  liveStep as botLiveStep,\n  tryDie,\n} from './bot';\nimport { add as addResource, generateRandom as generateRandomResource } from './resource';\nimport { mutate } from './mutation';\nimport { generate, step as programStep } from './program';\nimport { HEIGHT, WIDTH } from './world/constants';\nimport { getBot } from './world/bot_finder';\nimport { addBot } from './world/map_modifier';\n\n/**\n * Bot has 4 directions: right, up, left, down. Direction stored as code:\n * right - 0, up - 1, left - 2, down - 3. It is angle of rotation counterclockwise divided by 90.\n */\n\nfunction eachCell(world, performer) {\n  for (let x = 0; x < WIDTH; x += 1) {\n    for (let y = 0; y < HEIGHT; y += 1) {\n      performer(x, y);\n    }\n  }\n}\n\nfunction eachBot(world, performer, options) {\n  eachCell(world, (x, y) => {\n    const bot = getBot(x, y, world.map);\n    if (bot) {\n      performer(bot, options);\n    }\n  });\n}\n\nfunction populate(world) {\n  eachCell(world, (x, y) => {\n    if (Math.random() > 0.90) {\n      addBot(x, y, botGenerateRandom(x, y, generate), world.map);\n    }\n  });\n}\n\nfunction flushBotsProcessing(world) {\n  // Bots perform sequentially, cell by cell, so if bot perform in one cell and moved to other\n  // cell, it can lead to repeated performing. On the world step we mark bot as processing and\n  // bot will not performed again on this step. After processing bots we should flush bots\n  // locks.\n  eachBot(world, (bot) => {\n    bot.processing = false;\n  });\n}\n\nfunction initCell(x, y, map, value = { resources: {} }) {\n  if (map[x] === undefined) {\n    map[x] = [];\n  }\n\n  map[x][y] = value;\n}\n\n// function destroyBot(bot, world) {\n//   delete world.getCell(bot.x, bot.y).bot;\n// }\n\n/* PRIVATE */\nfunction initCells(world) {\n  eachCell(world, (x, y) => {\n    initCell(x, y, world.map);\n  });\n}\n\nfunction initResources(world) {\n  eachCell(world, (x, y) => {\n    if (Math.random() > 0.9) {\n      const resource = generateRandomResource();\n      addResource(x, y, resource, world.map);\n    }\n    const resourceLight = { light: { type: 'light', power: 1 - y / HEIGHT } };\n    addResource(x, y, resourceLight, world.map);\n  });\n}\n\nfunction step(world) {\n  // localStorage.world = JSON.stringify(this.map);\n\n  // Perform next action for every Bot\n  eachBot(world, (bot) => {\n    mutate(bot);\n    programStep(bot, world);\n    botLiveStep(bot);\n\n    const onDie = (deadBot, map) => {\n      // if (Math.random() > 0.3) {\n      const resource = generateRandomResource();\n      addResource(deadBot.x, deadBot.y, resource, map);\n      // }\n    };\n    tryDie(bot, world, onDie);\n  });\n  // debug(this.map[0][0].resources);\n\n  flushBotsProcessing(world);\n}\n\n// print() {\n//   let s = '';\n//   for (let y = 0; y < this.height; y += 1) {\n//     for (let x = 0; x < this.width; x += 1) {\n//       s += this.map[x][y].bot ? 1 : '.';\n//     }\n//     s += '\\n';\n//   }\n//   debug(s);\n// }\n\n// Creates world with population\nfunction createWorld() {\n  // Create world as matrix\n  const world = {\n    map: [],\n  };\n  initCells(world);\n\n  // Create bots in world\n  populate(world);\n  initResources(world);\n\n  window.debugWorld = world;\n  return world;\n}\n\nexport {\n  WIDTH,\n  HEIGHT,\n  createWorld,\n  eachBot,\n  eachCell,\n  getBot,\n  populate,\n  step,\n};\n","import {\n  eachBot, eachCell, HEIGHT, WIDTH,\n} from './domain/world';\nimport Bot from './domain/bot';\nimport { getCell } from './domain/world/map_modifier';\n\n/* accepts parameters\n * h  Object = {h:x, s:y, v:z}\n * OR\n * h, s, v\n * https://stackoverflow.com/questions/17242144/javascript-convert-hsb-hsv-color-to-rgb-accurately\n*/\nfunction HSVtoRGB(h, s, v) {\n  let r; let g; let b;\n  if (arguments.length === 1) {\n    s = h.s; v = h.v; h = h.h;\n  }\n  const i = Math.floor(h * 6);\n  const f = h * 6 - i;\n  const p = v * (1 - s);\n  const q = v * (1 - f * s);\n  const t = v * (1 - (1 - f) * s);\n  switch (i % 6) { // eslint-disable-line default-case\n    case 0: r = v; g = t; b = p; break;\n    case 1: r = q; g = v; b = p; break;\n    case 2: r = p; g = v; b = t; break;\n    case 3: r = p; g = q; b = v; break;\n    case 4: r = t; g = p; b = v; break;\n    case 5: r = v; g = p; b = q; break;\n  }\n  return {\n    r: Math.round(r * 255),\n    g: Math.round(g * 255),\n    b: Math.round(b * 255),\n  };\n}\n\nconst inMouth = (x, y, mouth) => x >= mouth[0] && x <= mouth[2] && y >= mouth[1] && y <= mouth[3];\n\nconst CELL_SIZE = 10;\n\n// Generates color depending on program\nfunction getColor(bot) {\n  const dots = [\n    0,\n    0.15,\n    0.3,\n    0.45,\n    0.6,\n    0.75,\n    0.9,\n  ];\n\n  const weights = bot.program.commands.map((operation) => dots[operation]);\n\n  const sum = weights.reduce((a, b) => a + b, 0);\n  const avg = (sum / weights.length) || 0;\n\n  return HSVtoRGB(bot.style.h, bot.style.s, avg);\n\n  // if (bot.options.hasBotInFront) {\n  // color = { r: 255, g: 0, b: 0 };\n  // } else {\n  // Bot becomes dark if hungry\n\n  // const g = 128 + parseInt(parseFloat(bot.id) * 128);\n\n  // color = { r: 0, g: g, b: 100 };\n  // color = HSVtoRGB(bot.style.h, bot.style.s, bot.style.v);\n  // color = {r: bot.style.h * 255, g: bot.style.s * 255, b: bot.style.v * 255}\n\n  // }\n  // bot = this.setColor(bot);\n}\n\nfunction writeImageDataPixel(x, y, color, imageData) {\n  let index = y * WIDTH * CELL_SIZE * 4 + x * 4;\n  imageData.data[index] = color.r;\n  index += 1;\n  imageData.data[index] = color.g;\n  index += 1;\n  imageData.data[index] = color.b;\n  index += 1;\n  imageData.data[index] = color.a === undefined ? 255 : color.a;\n}\n\nfunction writeCenter(mainBodyLeftX, mainBodyRightX, mainBodyTopY, mainBodyBottomY, lmouth, color, imageData) {\n  for (let x = mainBodyLeftX; x <= mainBodyRightX; x += 1) {\n    for (let y = mainBodyTopY; y <= mainBodyBottomY; y += 1) {\n      if (!inMouth(x, y, lmouth)) {\n        writeImageDataPixel(x, y, color, imageData);\n      }\n    }\n  }\n}\n\nfunction writeTopBottom(mainBodyLeftX, mainBodyRightX, botTopY, lmouth, color, imageData, botBottomY) {\n  for (let x = mainBodyLeftX; x <= mainBodyRightX; x += 1) {\n    // Top border\n    if (!inMouth(x, botTopY, lmouth)) {\n      writeImageDataPixel(x, botTopY, color, imageData); // {r: 255, g: 255, b: 255}\n    }\n\n    // Bottom border\n    if (!inMouth(x, botBottomY, lmouth)) {\n      writeImageDataPixel(x, botBottomY, color, imageData);\n    }\n  }\n}\n\nfunction writeLeftRight(mainBodyTopY, mainBodyBottomY, botLeftX, lmouth, color, imageData, botRightX) {\n  for (let y = mainBodyTopY; y <= mainBodyBottomY; y += 1) {\n    // Left border\n    if (!inMouth(botLeftX, y, lmouth)) {\n      writeImageDataPixel(botLeftX, y, color, imageData);\n    }\n\n    // Right border\n    if (!inMouth(botRightX, y, lmouth)) {\n      writeImageDataPixel(botRightX, y, color, imageData);\n    }\n  }\n}\n\n/**\n *  Bot structure\n *  - main body (X)\n *  - borders (b)\n *\n *  bbbbbbbb\n * bXXXXXXXXb\n * bXXXXXXXXb\n * bXXXXXXX\n * bXXXXXXX  <- mouth\n * bXXXXXXX\n * bXXXXXXX\n * bXXXXXXXXb\n * bXXXXXXXXb\n *  bbbbbbbb\n *\n * @param vx\n * @param vy\n * @param bot\n * @param direction\n * @param color\n * @param imageData\n */\n\nfunction writeImageDataBot(vx, vy, bot, direction, color, imageData) {\n  const mainBodyLeftX = vx + 1;\n  const mainBodyRightX = vx + CELL_SIZE - 2;\n  const mainBodyTopY = vy + 1;\n  const mainBodyBottomY = vy + CELL_SIZE - 2;\n\n  const botLeftX = vx;\n  const botRightX = vx + CELL_SIZE - 1;\n  const botTopY = vy;\n  const botBottomY = vy + CELL_SIZE - 1;\n\n  const mouthMargin = 4;\n  const mouthDepth = 1;\n\n  const mouth = {\n    [Bot.RIGHT]: [\n      botRightX - mouthDepth,\n      botTopY + mouthMargin,\n      botRightX,\n      botBottomY - mouthMargin,\n    ],\n    [Bot.TOP]: [\n      botLeftX + mouthMargin,\n      botTopY,\n      botRightX - mouthMargin,\n      botTopY + mouthDepth,\n    ],\n    [Bot.LEFT]: [\n      botLeftX,\n      botTopY + mouthMargin,\n      botLeftX + mouthDepth,\n      botBottomY - mouthMargin,\n    ],\n    [Bot.BOTTOM]: [\n      botLeftX + mouthMargin,\n      botBottomY - mouthDepth,\n      botRightX - mouthMargin,\n      botBottomY,\n    ],\n  };\n\n  const lmouth = mouth[direction];\n\n  writeLeftRight(mainBodyTopY, mainBodyBottomY, botLeftX, lmouth, color, imageData, botRightX);\n  writeTopBottom(mainBodyLeftX, mainBodyRightX, botTopY, lmouth, color, imageData, botBottomY);\n  writeCenter(mainBodyLeftX, mainBodyRightX, mainBodyTopY, mainBodyBottomY, lmouth, color, imageData);\n  // this.drawMouth(vx, vy, direction, imageData);\n}\n\nfunction drawBot(bot, imageData) {\n  const color = getColor(bot);\n  const x = bot.x * CELL_SIZE;\n  const y = bot.y * CELL_SIZE;\n  writeImageDataBot(x, y, bot, bot.direction, color, imageData);\n}\n\nfunction writeImageDataResource(vx, vy, color, imageData) {\n  for (let x = vx + 3; x < vx + CELL_SIZE - 3; x += 1) {\n    for (let y = vy + 3; y < vy + CELL_SIZE - 3; y += 1) {\n      writeImageDataPixel(x, y, color, imageData);\n    }\n  }\n}\n\nfunction drawResource(x, y, resources, imageData) {\n  if (resources.food) {\n    x *= CELL_SIZE;\n    y *= CELL_SIZE;\n    // const color = Math.random() > 0.5 ? { r: 140, g: 80, b: 0 } : { r: 0, g: 80, b: 0 };\n    const color = { r: 140, g: 80, b: 0 };\n    writeImageDataResource(x, y, color, imageData);\n  }\n}\n\nfunction drawResources(world, imageData) {\n  // Draw resources\n  eachCell(world, (x, y) => {\n    const cell = getCell(x, y, world.map);\n    if (cell.resources) {\n      drawResource(x, y, cell.resources, imageData);\n    }\n  });\n}\n\nfunction createDrawer(world) {\n  const canvas = document.getElementById('cnv');\n  canvas.width = WIDTH * CELL_SIZE;\n  canvas.height = HEIGHT * CELL_SIZE;\n\n  const drawer = {\n    world,\n    ctx: canvas.getContext('2d'),\n  };\n\n  drawer.ctx = canvas.getContext('2d');\n  drawer.ctx.imageSmoothingEnabled = false;\n\n  return drawer;\n}\n\n// Draw bots\nfunction drawEachBot(bot, options) { drawBot(bot, options.imageData); }\n\nfunction fill(imageData) {\n  imageData.data.fill(0);\n  // Fill entire canvas with black\n  for (let i = 0; i < WIDTH * CELL_SIZE * HEIGHT * CELL_SIZE * 4; i += 4) {\n    // imageData.data[i] = 0;\n    // imageData.data[i + 1] = 0;\n    // imageData.data[i + 2] = 0;\n    imageData.data[i + 3] = 255;\n  }\n}\n\nfunction redraw(drawer) {\n  const imageData = drawer.ctx.createImageData(WIDTH * CELL_SIZE, HEIGHT * CELL_SIZE);\n\n  fill(imageData);\n\n  // Draw resources\n  drawResources(drawer.world, imageData);\n\n  eachBot(drawer.world, drawEachBot, { imageData });\n\n  // Display data on canvas\n  drawer.ctx.putImageData(imageData, 0, 0);\n}\n\nexport {\n  createDrawer,\n  redraw,\n};\n","import { HEIGHT, WIDTH } from './domain/world/constants';\nimport { getBot } from './domain/world/bot_finder';\n\nconst debugOptions = {};\nlet world;\nlet counter = 0;\nwindow.counter = 0;\n\n// global vars for this module\nconst cnv = document.getElementById('cnv');\nconst info = document.getElementById('info');\nconst botWidth = cnv.clientWidth / WIDTH;\nconst botHeight = cnv.clientHeight / HEIGHT;\n\nconst updateDebugOptions = () => {\n  if (debugOptions.botX === undefined) return;\n  if (debugOptions.botY === undefined) return;\n  debugOptions.bot = getBot(debugOptions.botX, debugOptions.botY, world.map);\n};\n\nconst handleClick = (e) => {\n  debugOptions.botX = parseInt(e.x / botWidth, 10);\n  debugOptions.botY = parseInt(e.y / botHeight, 10);\n  updateDebugOptions();\n};\n\nfunction updateDebugWindow() {\n  const { bot } = debugOptions;\n  // When bot dies we should load new info\n  if (bot === undefined || (bot && bot.xp <= 0)) {\n    updateDebugOptions();\n    return;\n  }\n\n  info.innerHTML = `x: ${bot.x}</br>`\n    + `y: ${bot.y}</br>`\n    + `xp: ${parseInt(bot.xp, 10)}</br>`\n    + `program: ${bot.program.commands}</br>`\n    + `id: ${bot.id}</br>`;\n}\n\nfunction initDebugWindow(worldObject) {\n  world = worldObject;\n  cnv.addEventListener('mousedown', handleClick);\n\n  setInterval(updateDebugWindow, 1000);\n}\n\nString.prototype.hashCode = function () {\n  let hash = 0; let i; let\n    chr;\n  if (this.length === 0) return hash;\n  for (i = 0; i < this.length; i += 1) {\n    chr = this.charCodeAt(i);\n    hash = ((hash << 5) - hash) + chr;\n    hash |= 0; // Convert to 32bit integer\n  }\n  return hash;\n};\n\nfunction onTick(times) {\n  window.counter++;\n  counter += 1;\n  // const hash = JSON.stringify(window.debugWorld).hashCode();\n  window.debugInfo1 = `${counter} ${Date.now()} perf: ${times[0]}, ${times[1]} milliseconds`;\n  updateDebugWindow();\n}\n\nexport {\n  initDebugWindow,\n  onTick,\n};\n","import { createDrawer, redraw } from './drawer';\nimport {\n  createWorld, step as worldStep,\n} from './domain/world';\nimport { initDebugWindow, onTick } from './debug_window';\n// import M from './random.js';\n\n// let redraw;\n\nfunction debugPerformance(performer, param = undefined) {\n  const time = performance.now();\n  performer(param);\n  return performance.now() - time;\n}\n\nfunction step(world, drawer) {\n  worldStep(world);\n  redraw(drawer);\n\n  const t0 = debugPerformance(worldStep, world);\n  const t1 = debugPerformance(redraw, drawer);\n  // // Print performance debug information\n  onTick([t0, t1]);\n\n  requestAnimationFrame(() => step(world, drawer));\n}\n\n// window.debugInfo2 = {\n//   counter: 0,\n// };\n//\n// var canvas = document.getElementById('cnv');\n// var ctx = canvas.getContext('2d');\n// var W = 2500;\n// var H = 2500;\n// canvas.width = W;\n// canvas.height = H;\n//\n//\n// function test(timestamp) {\n//   window.debugInfo2.counter ++;\n//\n//   const imageData = ctx.createImageData(W, H);\n//\n//   // Fill entire canvas with black\n//   for (let i = 0; i < W * H * 4; i += 4) {\n//     imageData.data[i] = 200;\n//     imageData.data[i + 1] = 100;\n//     imageData.data[i + 2] = 0;\n//     imageData.data[i + 3] = 255;\n//   }\n//\n//   ctx.putImageData(imageData, 0, 0);\n//\n//   requestAnimationFrame(test);\n// }\n\nfunction run(world, drawer) {\n  // setInterval(() => {\n  //   console.log(Date.now(), window.debugInfo2); // eslint-disable-line no-console\n  // }, 1000);\n  // requestAnimationFrame(test);\n  // return\n\n  // worldStep = world.step.bind(world);\n  // redraw = drawer.redraw.bind(drawer);\n\n  // this.stepBusinessLogic();\n\n  requestAnimationFrame(() => step(world, drawer));\n\n  setInterval(() => {\n    console.log(Date.now(), window.debugInfo1); // eslint-disable-line no-console\n  }, 1000);\n\n  initDebugWindow(world);\n}\n\nfunction perform() {\n  const world = createWorld();\n  const drawer = createDrawer(world);\n  run(world, drawer);\n}\n\nfunction debug(msg) {\n  console.log(msg); // eslint-disable-line no-console\n}\n\n// stepBusinessLogic() {\n//   return new Promise((resolve, _) => {\n//     this.world.step();\n//     this.drawer.redraw();\n//     resolve();\n//   }).then((res) => {\n//     this.stepBusinessLogic();\n//   });\n// }\n\n// stepRedraw() {\n//\n// }\n\nexport default {\n  debug,\n  perform,\n};\n","import App from './app';\n\nApp.perform();\n\nconst worker = new Worker(new URL('./worker.js', import.meta.url));\n\nworker.onmessage = function(event) {\n  console.log(\"Message from worker:\", event.data); // [\"foo\", \"bar\", \"baz\"]\n};\n\nsetInterval(() => {\n  worker.ready.then( registration => {\n    registration.active.postMessage(\"Hi service worker\");\n    console.log('messages posted', registration)\n  });\n}, 2000);\n"],"names":["__webpack_require__","chunkId","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","length","Error","replace","p","b","baseURI","self","href","WIDTH","normalizeCoords","x","y","HEIGHT","SHIFTS","getBot","map","bot","rightCyclicShift","ar","push","shift","removeBot","addBot","validateCoords","getCell","DEFAULT_BOT","direction","id","rotate","program","commands","current","options","xp","style","h","s","generateId","Math","random","generateRandom","generateProgram","floor","v","liveStep","tryDie","world","onDie","cloneBot","changes","undefined","slice","processing","isProcessing","RIGHT","TOP","LEFT","BOTTOM","DEFAULT_XP","add","resource","resources","OPERATIONS","MOVE","CLONE","EAT","EAT_SOLAR","ROTATE_CLOCKWISE","ROTATE_COUNTERCLOCKWISE","arRandom","array","randomOperationCode","values","randomChangeStyleComponent","value","change","maxComponentValue","sign","execute","position","frontPosition","hasBotInFront","dest","setCellProps","moveBot","_world","cell","food","light","power","backPosition","newBot","operation","items","generate","i","eachCell","performer","eachBot","mutations","mutateSubstitution","splice","mutateDeletion","mutateInsertion","mutate","deadBot","type","flushBotsProcessing","inMouth","mouth","CELL_SIZE","writeImageDataPixel","color","imageData","index","data","r","a","drawEachBot","dots","weights","avg","reduce","arguments","f","q","t","round","HSVtoRGB","getColor","vx","vy","mainBodyLeftX","mainBodyRightX","mainBodyTopY","mainBodyBottomY","botLeftX","botRightX","botTopY","botBottomY","lmouth","writeLeftRight","writeTopBottom","writeCenter","writeImageDataBot","drawBot","redraw","drawer","ctx","createImageData","fill","writeImageDataResource","drawResource","drawResources","putImageData","debugOptions","counter","cnv","getElementById","info","botWidth","clientWidth","botHeight","clientHeight","updateDebugOptions","botX","botY","handleClick","parseInt","updateDebugWindow","innerHTML","initDebugWindow","worldObject","addEventListener","setInterval","debugPerformance","param","time","performance","now","times","debugInfo1","Date","requestAnimationFrame","String","hashCode","chr","hash","charCodeAt","initCell","initCells","populate","initResources","debugWorld","createWorld","canvas","width","height","getContext","imageSmoothingEnabled","createDrawer","console","log","run","worker","Worker","URL","onmessage","event","ready","then","registration","active","postMessage"],"sourceRoot":""}